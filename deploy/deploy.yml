# Heli Wang
# 2014/07/17
#
# deploy/deploy.yml
#
# Ansible playbook for running varstar deploy

---

- hosts: varstar
  user: oklrelease
  vars_files:
    - "{{ ans_loc }}/roles/common/vars/deploy.yml"
  tasks:
    - include: "{{ ans_loc }}/roles/common/tasks/deploy.yml"

    - name: grab dependencies
      command: chdir="{{ release_dir }}"
               /usr/local/bin/lein deps

    - name: start webserver
      shell: chdir="{{ release_dir }}"
             /usr/local/bin/lein ring server-headless &
